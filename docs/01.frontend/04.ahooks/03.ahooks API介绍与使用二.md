---
title: ahooks API介绍与使用二
date: 2023-09-23 14:54:41
permalink: /pages/d4ff16/
categories:
  - frontend
  - ahooks
---
## 21. useLocalStorageState

useLocalStorageState 是一个用于管理 localStorage 中状态的 Hook。

```js
import { useLocalStorageState } from "ahooks";

function App() {
  const [value, setValue] = useLocalStorageState("user", "default");

  return (
    <div>
      <p>{value}</p>
      <button onClick={() => setValue("A User")}>Set Name</button>
    </div>
  );
}
```

在上述代码中，useLocalStorageState 接收两个参数。第一个参数是 localStorage 中的键名，第二个参数是默认值。这个 Hook 会返回一个数组，第一个元素是当前的值，第二个元素是一个用于设置该值的函数。

## 22. useSessionStorageState

`useSessionStorageState`是一个用于管理 sessionStorage 中状态的 Hook。

```js
import { useSessionStorageState } from "ahooks";

function App() {
  const [value, setValue] = useSessionStorageState("user", "default");

  return (
    <div>
      <p>{value}</p>
      <button onClick={() => setValue("A User")}>Set Name</button>
    </div>
  );
}
```

在上述代码中，`useSessionStorageState` 接收两个参数。第一个参数是 sessionStorage 中的键名，第二个参数是默认值。这个 Hook 会返回一个数组，第一个元素是当前的值，第二个元素是一个用于设置该值的函数。

## 23. useClickAway

`useClickAway` 是一个用于在用户点击元素外部时触发函数的 Hook。

```js
import { useRef } from "react";
import { useClickAway } from "ahooks";

function App() {
  const ref = useRef();

  useClickAway(() => {
    console.log("User clicked away!");
  }, ref);

  return <div ref={ref}>Click outside this area</div>;
}
```

在上述代码中，`useClickAway` 接收一个函数和一个 ref 作为参数。当用户点击 ref 指向的元素外部时，会执行传入的函数。

## 24. usePersistFn

`usePersistFn` 是一个可以返回稳定的函数引用的 Hook，即使依赖项改变，返回的函数引用也不会改变。

```js
import { usePersistFn } from "ahooks";

function App() {
  const show = usePersistFn(() => {
    console.log("Hello World");
  });

  return (
    <div>
      <button onClick={show}>Show</button>
    </div>
  );
}
```

在上述代码中，`usePersistFn` 接收一个函数作为参数，返回一个稳定的函数引用。这对于避免因函数引用改变而引发的不必要的渲染非常有用。

## 25. useCreation

`useCreation` 是一个用于在组件初次渲染时创建并保持稳定的值的 Hook。

```js
import { useCreation } from "ahooks";

function App() {
  const value = useCreation(() => Math.random(), []);

  return (
    <div>
      <p>{value}</p>
    </div>
  );
}
```

在上述代码中，`useCreation` 接收两个参数。第一个参数是一个工厂函数，用于创建初始值，第二个参数是一个数组，包含了所有的依赖项。这个 Hook 会在组件初次渲染时执行工厂函数，并返回创建的值。

对不起，我犯了个错误。让我们继续介绍其他的 Hook：

## 26. useFullscreen

    `useFullscreen` 是一个用于控制元素全屏状态的 Hook。

```js
import { useRef } from "react";
import { useFullscreen } from "ahooks";

function App() {
  const ref = useRef();
  const { setFull, exitFull, toggleFull } = useFullscreen(ref);

  return (
    <div ref={ref}>
      <button onClick={toggleFull}>Toggle Fullscreen</button>
    </div>
  );
}
```

在上述代码中，`useFullscreen` 接收一个 ref 作为参数，并返回一个对象，该对象包含 `setFull`、`exitFull` 和 `toggleFull` 这些方法，用于控制元素的全屏状态。

## 27. useInViewport

`useInViewport` 是一个用于检测元素是否在视口内的 Hook。

```js
import { useRef } from "react";
import { useInViewport } from "ahooks";

function App() {
  const ref = useRef();
  const inViewport = useInViewport(ref);

  return <div ref={ref}>{inViewport ? "In viewport" : "Not in viewport"}</div>;
}
```

在上述代码中，`useInViewport` 接收一个 ref 作为参数，并返回一个布尔值，表示元素是否在视口内。

28. `useMouse`

`useMouse` 是一个用于获取鼠标位置的 Hook。

```js
import { useMouse } from "ahooks";

function App() {
  const mouse = useMouse();

  return (
    <div>
      Current mouse position: {mouse.x}, {mouse.y}
    </div>
  );
}
```

在上述代码中，`useMouse` 返回一个对象，该对象包含鼠标的当前 x 和 y 坐标。

非常抱歉之前的误会。让我们从序号 28 开始，介绍你提到的这些 ahooks 库中的 API：

## 28. useInfiniteScroll

`useInfiniteScroll` 是一个实现无限滚动功能的 Hook。

```js
import { useInfiniteScroll } from "ahooks";

function App() {
  const { list, loading, loadMore, hasMore } = useInfiniteScroll(service);

  return (
    <div>
      {list.map((item, index) => (
        <div key={index}>{item}</div>
      ))}
      {loading && <div>Loading...</div>}
      {!loading && hasMore && <div onClick={loadMore}>Load more</div>}
    </div>
  );
}
```

在上述代码中，`useInfiniteScroll` 接受一个异步函数 `service` 作为参数，返回一个包含 `list`、`loading`、`loadMore` 和 `hasMore` 的对象。

## 29. usePagination

`usePagination` 是一个实现分页功能的 Hook。

```jsx
import { usePagination } from "ahooks";

function App() {
  const { tableProps, paginationProps } = usePagination(service);

  return (
    <Table {...tableProps}>
      <Pagination {...paginationProps} />
    </Table>
  );
}
```

在上述代码中，`usePagination` 接受一个异步函数 `service` 作为参数，返回一个包含 `tableProps` 和 `paginationProps` 的对象，这些属性可以直接传递给 `Table` 和 `Pagination` 组件。

## 30. useDynamicList

`useDynamicList` 是一个用于处理动态列表的 Hook。

```js
import { useDynamicList } from "ahooks";

function App() {
  const { list, remove, push } = useDynamicList([1, 2, 3]);

  return (
    <div>
      {list.map((ele, index) => (
        <div key={index}>
          <span>{ele}</span>
          <button onClick={() => remove(index)}>Remove</button>
        </div>
      ))}
      <button onClick={() => push(Date.now())}>Add</button>
    </div>
  );
}
```

在上述代码中，`useDynamicList` 接受一个初始列表作为参数，返回一个包含 `list`、`remove` 和 `push` 的对象。

## 31. useVirtualList

`useVirtualList` 是一个用于虚拟列表渲染的 Hook。

```js
import { useVirtualList } from "ahooks";

function App() {
  const { list, containerProps, wrapperProps } = useVirtualList(data, {
    itemHeight: 60,
  });

  return (
    <div {...containerProps}>
      <div {...wrapperProps}>
        {list.map((ele, index) => (
          <div key={index} style={{ height: 60 }}>
            Row: {ele.data}
          </div>
        ))}
      </div>
    </div>
  );
}
```

在上述代码中，`useVirtualList` 接受一个数据列表和一个包含项目高度的对象作为参数，返回一个包含 `list`、`containerProps` 和 `wrapperProps` 的对象。

## 32. useHistoryTravel

`useHistoryTravel` 是一个用于管理历史记录的 Hook，可以实现撤销、重做等功能。

```js
import { useHistoryTravel } from "ahooks";

function App() {
  const { value, setValue, back, forward, go } = useHistoryTravel();

  return (
    <div>
      <input value={value} onChange={(e) => setValue(e.target.value)} />
      <button onClick={back}>Back</button>
      <button onClick={forward}>Forward</button>
      <button onClick={() => go(2)}>Go to 2</button>
    </div>
  );
}
```

在上述代码中，`useHistoryTravel` 返回一个包含 `value`、`setValue`、`back`、`forward`、`go` 的对象。

## 33. useNetwork

`useNetwork` 是一个用于获取网络状态的 Hook。

```js
import { useNetwork } from "ahooks";

function App() {
  const networkState = useNetwork();

  return (
    <div>
      <span>Network type: {networkState.type}</span>
      <span>Online: {String(networkState.online)}</span>
    </div>
  );
}
```

在上述代码中，`useNetwork` 返回一个包含网络状态的对象，对象包括 `type`（网络类型）和 `online`（是否在线）。

## 34. useSelections

`useSelections` 是用于管理一组条目的选中状态的 Hook。

```js
import { useSelections } from "ahooks";

function App() {
  const {
    selected,
    allSelected,
    isSelected,
    toggle,
    toggleAll,
    partiallySelected,
  } = useSelections(["a", "b", "c"], ["a"]);

  return (
    <div>
      <div>Selected: {selected.join(", ")}</div>
      <div>AllSelected: {String(allSelected)}</div>
      <div>PartiallySelected: {String(partiallySelected)}</div>
      <button onClick={() => toggle("b")}>Toggle b</button>
      <button onClick={toggleAll}>Toggle All</button>
    </div>
  );
}
```

在上述代码中，`useSelections` 接受一个所有条目的数组和一个初始选中条目的数组，返回一个包含 `selected`、`allSelected`、`isSelected`、`toggle`、`toggleAll`、`partiallySelected` 的对象。

## 35. useCountDown

`useCountDown` 是一个倒计时的 Hook。

```js
import { useCountDown } from "ahooks";

function App() {
  const [targetDate, setTargetDate] = useState(Date.now() + 5000);
  const {
    days,
    hours,
    minutes,
    seconds,
    milliseconds,
    start,
    pause,
    resume,
    reset,
  } = useCountDown(targetDate);

  return (
    <div>
      <p>{`${days} days, ${hours} hours, ${minutes} minutes, ${seconds} seconds, ${milliseconds} milliseconds`}</p>
      <button onClick={start}>Start</button>
      <button onClick={pause}>Pause</button>
      <button onClick={resume}>Resume</button>
      <button onClick={() => reset(targetDate)}>Reset</button>
    </div>
  );
}
```

在上述代码中，`useCountDown` 接受一个目标日期，返回一个包含 `days`、`hours`、`minutes`、`seconds`、`milliseconds`、`start`、`pause`、`resume`、`reset` 的对象。

## 36. useTextSelection

`useTextSelection` 是一个用于获取用户选中文本信息的 Hook。

```js
import { useTextSelection } from "ahooks";

function App() {
  const selectionInfo = useTextSelection();

  return (
    <div>
      <p>Select some text from this page.</p>
      <p>Selection: {selectionInfo.text}</p>
    </div>
  );
}
```

在上述代码中，`useTextSelection` 不需要任何参数，返回一个包含选中文本信息的对象。

## 37. useWebSocket

`useWebSocket` 是一个用于 WebSocket 连接的 Hook。

```js
import { useWebSocket } from "ahooks";

function App() {
  const {
    latestMessage,
    sendMessage,
    connect,
    disconnect,
    readyState,
    readyStateLabel,
  } = useWebSocket("wss://echo.websocket.org");

  return (
    <div>
      <p>Latest message: {latestMessage?.data || "None"}</p>
      <button onClick={() => sendMessage({ msg: "Hello" })}>
        Send Message
      </button>
      <button onClick={connect}>Connect</button>
      <button onClick={disconnect}>Disconnect</button>
      <p>Ready state: {readyStateLabel}</p>
    </div>
  );
}
```

在上述代码中，`useWebSocket` 接受一个 WebSocket URL，返回一个包含 `latestMessage`、`sendMessage`、`connect`、`disconnect`、`readyState`、`readyStateLabel` 的对象。

## 38. useUrlState

`useUrlState` 是一个用于管理 URL 状态的 Hook。

```js
import { useUrlState } from "ahooks";

function App() {
  const [state, setState] = useUrlState({ name: "ahooks" });

  return (
    <div>
      <p>Name: {state.name}</p>
      <button onClick={() => setState({ name: "newName" })}>Set Name</button>
    </div>
  );
}
```

在上述代码中，`useUrlState` 接受一个初始状态对象，返回一个类似 `useState` 的元组。

## 39. useCookieState

`useCookieState` 是一个用于管理 cookie 状态的 Hook。

```js
import { useCookieState } from "ahooks";

function App() {
  const [value, setValue] = useCookieState("my-cookie");

  return (
    <div>
      <p>Value: {value}</p>
      <button onClick={() => setValue("newValue")}>Set Value</button>
    </div>
  );
}
```

在上述代码中，`useCookieState` 接受一个 cookie 名称，返回一个类似 `useState` 的元组。

## 40. useMap

`useMap` 是一个用于管理 Map 状态的 Hook。

```js
import { useMap } from "ahooks";

function App() {
  const [map, { set, setAll, remove, reset, has }] = useMap(
    new Map([["hello", "world"]])
  );

  return (
    <div>
      <p>Value: {map.get("hello")}</p>
      <button onClick={() => set("hello", "newWorld")}>Set Value</button>
    </div>
  );
}
```

在上述代码中，`useMap` 接受一个 Map，返回一个包含 Map 和一些操作方法的元组。
